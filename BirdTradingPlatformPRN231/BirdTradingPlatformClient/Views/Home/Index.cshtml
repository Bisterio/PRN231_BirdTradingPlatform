@model BusinessObject.DTOs.CustomerDashboardDTO

@{
    if (User.Identity.IsAuthenticated)
    {
        Layout = "_LayoutCustomer";
    }
    ViewData["Title"] = "Home Page";
}

<section class="home-one mt30">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="main-banner-wrapper home1_style bdrs6 ovh">
                    <div class="banner-style-one owl-theme owl-carousel">
                        <div class="slide slide-one"
                             style="background-image:url(image/home1.png);height:600px">
                            <div class="container">
                                <div class="row home-content">
                                    <div class="col-lg-6 offset-lg-1 col-xl-5">
                                        <span class="tag">
                                            BTP
                                        </span>
                                        <h3 class="banner-title">
                                            <span class="fw400">
                                                Buy pet birds,
                                                <br>magpie-robin, canary<br class="d-none d-xl-block">& more
                                            </span>
                                        </h3>
                                        <a asp-action="Index" asp-controller="Product"
                                           class="btn banner-btn btn-thm">Shop Now</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="slide slide-one"
                             style="background-image:url(image/home2.png);height:600px">
                            <div class="container">
                                <div class="row home-content">
                                    <div class="col-lg-5 offset-lg-1">
                                        <span class="tag">
                                            BTP
                                        </span>
                                        <h3 class="banner-title">
                                            <span class="fw400">
                                                Bird food
                                            <br>and Supplementary
                                            </span>
                                        </h3>
                                        <a asp-action="Index" asp-controller="Product"
                                           class="btn banner-btn btn-thm">Shop Now</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="slide slide-one bgpc"
                             style="background-image:url(image/home3.png);height:600px">
                            <div class="container">
                                <div class="row home-content">
                                    <div class="col-lg-5 offset-lg-1">
                                        <span class="tag">New Arrivals</span>
                                        <h3 class="banner-title">
                                            <span class="fw400">
                                                Bird cages
                                            <br>and many more accessories
                                            </span>
                                        </h3>
                                        <a asp-action="Index" asp-controller="Product"
                                           class="btn banner-btn btn-thm">Shop Now</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-btn-block banner-carousel-btn">
                        <span class="carousel-btn left-btn">
                            <i class="fas fa-chevron-left left"></i>
                        </span><span class="carousel-btn right-btn"><i class="fas fa-chevron-right right"></i></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<section class="top-category pb30 pt20">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="d-flex justify-content-between">
                    <div class="main-title">
                        <h2>Shop by Category</h2>
                    </div>
                    <div class="main-title mb-5">
                    </div>
                </div>
            </div>
        </div>
        <div class="row ovh">
            <div class="col-6 col-md-3 col-xl wow fadeInUp" data-wow-duration=".7s">
                <a asp-action="Index" asp-controller="Product" asp-route-category="1">
                    <div class="iconbox">
                        <div class="icon"><img src="~/image/bird-category.png" alt="Category Image"></div>
                        <div class="details">
                            <h5 class="title">Birds</h5>
                        </div>
                    </div>
                </a>
            </div>
            <div class="col-6 col-md-3 col-xl wow fadeInUp" data-wow-duration=".9s">
                <a asp-action="Index" asp-controller="Product" asp-route-category="2">
                    <div class="iconbox">
                        <div class="icon"><img src="~/image/bird-food-category.png" alt="Category Image"></div>
                        <div class="details">
                            <h5 class="title">Bird Food</h5>
                        </div>
                    </div>
                </a>
            </div>
            <div class="col-6 col-md-3 col-xl wow fadeInUp" data-wow-duration="1.1s">
                <a asp-action="Index" asp-controller="Product" asp-route-category="3">
                    <div class="iconbox">
                        <div class="icon"><img src="~/image/bird-accessory-category.png" alt="Category Image"></div>
                        <div class="details">
                            <h5 class="title">Accessories</h5>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>
</section>
<section class="featured-product pt0 pb90">
    <div class="container">
        <div class="row">
            <div class="col-lg-6">
                <div class="main-title mb0-sm">
                    <h2>Best sellers</h2>
                </div>
            </div>
            <div class="col-lg-6">
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="popular_listing_sliders row ui_kit_tab style2">
                    <div class="tab-content col-lg-12" id="nav-tabContent">
                        <div class="tab-pane fade show active" id="nav-home" role="tabpanel"
                             aria-labelledby="nav-home-tab">
                            <div class="best_item_slider_shop_lising_page shop_item_5grid_slider slider_dib_sm nav_none_400 dots_none owl-theme owl-carousel">
                                @if (Model.TopSellingProducts.Count == 0)
                                {
                                    <div class="item ovh">
                                        <h5 class="text-center">No products to be shown</h5>
                                    </div>
                                }
                                else
                                {
                                    @foreach (var product in Model.TopSellingProducts)
                                    {
                                        <div class="item ovh">
                                            <div class="shop_item bdrtrb1 px-2 px-sm-3 wow fadeIn" data-wow-duration="1.3s">
                                                <div class="thumb pb30">
                                                    <img style="height: 200px" class="rounded mx-auto d-block" src="@product.Image" alt="Best Seller Item">
                                                    <div class="shop_item_cart_btn d-grid">
                                                        <button data-id="@product.ProductId" class="add-cart-btn-top btn btn-thm">Add to Cart</button>
                                                    </div>
                                                </div>
                                                <div class="details">
                                                    <div class="sub_title">@product.CategoryName</div>
                                                    <div class="title" style="height:3.5em; display: -webkit-box;-webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;">
                                                        <a asp-action="Detail" asp-controller="Product" asp-route-id="@product.ProductId">
                                                            @product.Name
                                                        </a>
                                                    </div>
                                                    <div class="si_footer">
                                                        <div class="price">@product.UnitPrice.ToString("#,##0").Replace(",",".") VND</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<section class="featured-product pt0">
    <div class="container">
        <div class="row">
            <div class="col-md-5">
                <div class="main-title mb0-sm">
                    <h2>Most recent products</h2>
                </div>
            </div>
            <div class="col-md-7">
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="popular_listing_sliders row ui_kit_tab style2">
                    <div class="tab-content col-lg-12" id="nav-tabContent2">
                        <div class="tab-pane fade show active" id="nav-narive" role="tabpanel"
                             aria-labelledby="nav-narive-tab">
                            <div class="best_item_slider_shop_lising_page shop_item_5grid_slider slider_dib_sm nav_none_400 dots_none owl-theme owl-carousel">
                                @if (Model.RecentProducts.Count == 0)
                                {
                                    <div class="item ovh">
                                        <h5 class="text-center">No products to be shown</h5>
                                    </div>
                                }
                                else
                                {
                                    @foreach (var product in Model.RecentProducts)
                                    {
                                        <div class="item ovh">
                                            <div class="shop_item bdrtrb1 px-2 px-sm-3 wow fadeIn" data-wow-duration="1.3s">
                                                <div class="thumb pb30">
                                                    <img style="height: 200px" class="rounded mx-auto d-block" src="@product.Image" alt="Best Seller Item">
                                                    <div class="shop_item_cart_btn d-grid">
                                                        <button data-id="@product.ProductId" class="add-cart-btn-recent btn btn-thm">Add to Cart</button>
                                                    </div>
                                                </div>
                                                <div class="details">
                                                    <div class="sub_title">@product.CategoryName</div>
                                                    <div class="title" style="height:3.5em; display: -webkit-box;-webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;">
                                                        <a asp-action="Detail" asp-controller="Product" asp-route-id="@product.ProductId">
                                                            @product.Name
                                                        </a>
                                                    </div>
                                                    <div class="si_footer">
                                                        <div class="price">@product.UnitPrice.ToString("#,##0").Replace(",",".") VND</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
@section Scripts {
    <script>
        $(document).ready(function () {
            var topProductList = @Html.Raw(Json.Serialize(Model.TopSellingProducts));
            var recentProductList = @Html.Raw(Json.Serialize(Model.RecentProducts));

            // Set add to cart button onclick for top products
            $(".add-cart-btn-top").unbind().on('click', function () {
                var clickedItemId = $(this).data("id");
                var clickedItem = topProductList.find(obj => {
                    return obj.productId == clickedItemId;
                });

                let cart = {};
                if (localStorage.getItem("cart")) {
                    cart = JSON.parse(localStorage.getItem("cart"));
                };

                if (clickedItemId in cart) {
                    if (cart[clickedItemId].quantity < clickedItem.stock) {
                        cart[clickedItemId].quantity++;
                    }
                } else {
                    let cartItem = {
                        product: clickedItem,
                        storeId: clickedItem.storeId,
                        quantity: 1
                    };
                    cart[clickedItemId] = cartItem
                }

                localStorage.setItem("cart", JSON.stringify(cart));
                loadCart();
            });

            // Set add to cart button onclick for recent products
            $(".add-cart-btn-recent").unbind().on('click', function () {
                var clickedItemId = $(this).data("id");
                var clickedItem = recentProductList.find(obj => {
                    return obj.productId == clickedItemId;
                });

                let cart = {};
                if (localStorage.getItem("cart")) {
                    cart = JSON.parse(localStorage.getItem("cart"));
                };

                if (clickedItemId in cart) {
                    if (cart[clickedItemId].quantity < clickedItem.stock) {
                        cart[clickedItemId].quantity++;
                    }
                } else {
                    let cartItem = {
                        product: clickedItem,
                        storeId: clickedItem.storeId,
                        quantity: 1
                    };
                    cart[clickedItemId] = cartItem
                }

                localStorage.setItem("cart", JSON.stringify(cart));
                loadCart();
            });
        });
    </script>
}